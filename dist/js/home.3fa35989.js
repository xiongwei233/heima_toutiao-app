"use strict";(self["webpackChunkheima_toutiao_app"]=self["webpackChunkheima_toutiao_app"]||[]).push([[177],{7377:function(t,e,n){n.r(e),n.d(e,{default:function(){return w}});var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("van-nav-bar",{attrs:{fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[s("img",{staticClass:"logo",attrs:{src:n(3018)}})]},proxy:!0},{key:"right",fn:function(){return[s("van-icon",{attrs:{name:"search",size:"4.8vw",color:"#fff"},on:{click:t.moveSearch}})]},proxy:!0}])}),s("van-tabs",{attrs:{duration:"0",animated:"",sticky:"","offset-top":"12.266667vw"},on:{change:t.changeChangeFn},model:{value:t.channelId,callback:function(e){t.channelId=e},expression:"channelId"}},t._l(t.channelsList,(function(e){return s("van-tab",{key:e.id,attrs:{name:e.id,title:e.name}},[s("artile-list",{attrs:{channelId:t.channelId}})],1)})),1),s("van-icon",{staticClass:"pushClass",attrs:{name:"plus"},on:{click:t.addchannel}}),s("van-popup",{staticClass:"popupClass",model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[s("channel-edit",{ref:"editRef",attrs:{channel:t.channelsList,unCheckChannel:t.unCheckChannelsList},on:{closePopup:t.closePopupFn,addEv:t.addEvFn,removeEv:t.removeEvFn,closeEv:t.closeEvFn},model:{value:t.channelId,callback:function(e){t.channelId=e},expression:"channelId"}})],1)],1)},a=[],i=n(8364),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"margin-top":"1.333333vw"}},[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",offset:"50","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return n("artile-item",{key:e.art_id,attrs:{arrChildren:e},on:{dislikes:t.dislikesFn,reports:t.reportsFn},nativeOn:{click:function(n){return t.itemClickFn(e.art_id)}}})})),1)],1)],1)},c=[],o=(n(5642),n(8398)),r=n(9119),h={name:"ArtileList",props:{channelId:Number},components:{artileItem:r.Z},data(){return{list:[],loading:!1,finished:!1,theTime:"",isLoading:!1}},created(){this.changeChangeFn()},methods:{async getArticleListFn(){const t=await(0,i.ZQ)({channel_id:this.channelId,timestamp:this.theTime||(new Date).getTime()});this.list=[...this.list,...t.data.data.results],this.theTime=t.data.data.pre_timestamp,this.loading=!1,null===t.data.data.pre_timestamp&&(this.finished=!0),this.isLoading=!1},async changeChangeFn(){try{this.getArticleListFn()}catch(t){this.$toast.fail("获取用户的频道的数据失败")}},async onLoad(){try{if(0===this.list.length)return void(this.finished=!0);this.getArticleListFn()}catch(t){this.$toast.fail("获取用户的频道的数据失败")}},async onRefresh(){this.list=[],this.theTime=(new Date).getTime(),this.getArticleListFn()},async dislikesFn(t){try{await(0,i.RN)(t),(0,o.Z)({type:"success",message:"反馈成功"})}catch(e){(0,o.Z)({type:"danger",message:e.message})}},async reportsFn(t,e,n){try{await(0,i.VM)({target:t,type:e,remark:n}),(0,o.Z)({type:"success",message:"举报成功"})}catch(s){}},itemClickFn(t){this.$router.push({path:`/detail?art_id=${t}`})}}},d=h,u=n(1001),m=(0,u.Z)(d,l,c,!1,null,"f939160a",null),p=m.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-nav-bar",{attrs:{title:"编辑频道",fixed:"",placeholder:"","safe-area-inset-top":""},on:{"click-left":t.onClickLeft},scopedSlots:t._u([{key:"left",fn:function(){return[n("van-icon",{attrs:{name:"cross",size:"4.8vw"}})]},proxy:!0}])}),n("div",[n("van-cell",{staticClass:"tagBox",attrs:{border:!1},scopedSlots:t._u([{key:"right-icon",fn:function(){return[n("span",{staticClass:"buttonChannel",attrs:{type:"default",size:"mini"},on:{click:t.addRemoveChannel}},[t._v(t._s(t.isEdit?"完成":"编辑"))])]},proxy:!0}])},[[n("span",{staticClass:"custom-title"},[t._v("我的频道")]),n("span",{staticClass:"tagChannel"},[t._v("点击"+t._s(t.isEdit?"删除":"进入")+"频道")])]],2),n("van-grid",{attrs:{direction:"horizontal","column-num":4,gutter:10}},t._l(t.channel,(function(e){return n("van-grid-item",{key:e.id,on:{click:function(n){return t.removeChannel(e)}}},[t._v(" "+t._s(e.name)+" "),n("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.isEdit&&0!==e.id,expression:"isEdit && item.id !== 0 "}],staticClass:"removeChannel",attrs:{name:"cross"}})],1)})),1)],1),n("div",[n("van-cell",{staticClass:"tagBox",attrs:{border:!1}},[[n("span",{staticClass:"custom-title"},[t._v("推荐频道")]),n("span",{staticClass:"tagChannel"},[t._v("点击添加频道")])]],2),n("van-grid",{attrs:{direction:"horizontal","column-num":4,gutter:10}},t._l(t.unCheckChannel,(function(e){return n("van-grid-item",{key:e.id,on:{click:function(n){return t.addChannel(e)}}},[t._v(t._s(e.name))])})),1)],1)],1)},f=[],g={name:"channelEdit",props:{channel:Array,unCheckChannel:Array},data(){return{isEdit:!1}},created(){},methods:{onClickLeft(){this.$emit("closePopup")},addRemoveChannel(){this.isEdit=!this.isEdit},removeChannel(t){this.isEdit?0!==t.id&&this.$emit("removeEv",t):(this.$emit("closeEv"),this.$emit("input",t.id))},addChannel(t){this.isEdit&&this.$emit("addEv",t)}},components:{}},C=g,y=(0,u.Z)(C,v,f,!1,null,"e33a3f5c",null),k=y.exports,L={name:"layoutHome",data(){return{channelId:0,channelsList:[],allChannelsList:[],artileList:[],isShow:!1,channelScrollTObj:{}}},async created(){this.getChannelsList()},methods:{async getChannelsList(){try{const t=await(0,i["if"])();this.channelsList=t.data.data.channels;const e=await(0,i.qH)();this.allChannelsList=e.data.data.channels,this.changeChangeFn()}catch(t){this.$toast.fail("获取用户的频道失败")}},async changeChangeFn(t){this.$nextTick((()=>{document.documentElement.scrollTop=this.channelScrollTObj[this.channelId],console.log(this.channelScrollTObj[this.channelId])})),console.log("name的值"+t);try{const t=await(0,i.ZQ)({channel_id:this.channelId,timestamp:(new Date).getTime()});this.artileList=t.data.data.results}catch(e){this.$toast.fail("获取用户的频道的数据失败")}},addchannel(){this.isShow=!0},closePopupFn(){this.isShow=!1,this.$refs.editRef.isEdit=!1},closeEvFn(){this.isShow=!1},async addEvFn(t){try{this.channelsList.push(t);const e=this.channelsList.filter((t=>0!==t.id)),n=e.map(((t,e)=>{const n={...t};return delete n.name,n.seq=e,n}));await(0,i.bb)({channels:n})}catch(e){this.$toast.fail("频道添加失败"),this.getChannelsList()}},async removeEvFn(t){try{const e=this.channelsList.findIndex((e=>e.id===t.id));this.channelsList.splice(e,1),await(0,i.cS)({id:t.id})}catch(e){this.$toast.fail("频道删除失败"),this.getChannelsList()}},moveSearch(){this.$router.push("/search")},scrollFn(){this.$route.meta.scrollTValue=document.documentElement.scrollTop,this.channelScrollTObj[this.channelId]=document.documentElement.scrollTop,console.log(this.channelScrollTObj)}},computed:{unCheckChannelsList(){return this.allChannelsList.filter((t=>-1===this.channelsList.findIndex((e=>t.id===e.id))))}},activated(){console.log(this.$route),window.addEventListener("scroll",this.scrollFn),document.documentElement.scrollTop=this.$route.meta.scrollTValue},deactivated(){window.removeEventListener("scroll",this.scrollFn)},components:{artileList:p,channelEdit:k}},_=L,E=(0,u.Z)(_,s,a,!1,null,"9b7e4b4e",null),w=E.exports},3018:function(t,e,n){t.exports=n.p+"img/toutiao_logo.d0d391a4.png"}}]);
//# sourceMappingURL=home.3fa35989.js.map