"use strict";(self["webpackChunkheima_toutiao_app"]=self["webpackChunkheima_toutiao_app"]||[]).push([[464],{7998:function(t,e,s){s.r(e),s.d(e,{default:function(){return l}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"appBox"},[s("form",{attrs:{action:"/"}},[s("van-search",{directives:[{name:"inputFocus",rawName:"v-inputFocus"}],staticClass:"searchClass",attrs:{"show-action":"",placeholder:"请输入搜索关键词",clearable:"",shape:"round",fixed:""},on:{search:t.onSearch,cancel:t.onCancel,clear:t.clearSearch,input:t.inputFn},model:{value:t.searchValue,callback:function(e){t.searchValue="string"===typeof e?e.trim():e},expression:"searchValue"}})],1),0===t.searchValue.length?s("div",[s("van-cell",{staticClass:"tagBox",scopedSlots:t._u([{key:"right-icon",fn:function(){return[s("van-icon",{attrs:{name:"delete-o",size:"4.266667vw"},on:{click:t.clearFn}})]},proxy:!0}],null,!1,2059379864)},[[s("span",{staticClass:"custom-title"},[t._v("历史记录")])]],2),s("van-grid",{staticClass:"gridBox",attrs:{gutter:10}},t._l(t.searchHistory,(function(e,a){return s("span",{key:a,on:{click:function(s){return t.onHistory(e)}}},[t._v(t._s(e))])})),0)],1):s("div",t._l(t.searchSuggestionList,(function(e,a){return s("van-cell",{key:a,attrs:{icon:"search"},on:{click:function(s){return t.onSuggest(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{domProps:{innerHTML:t._s(t.highlight(e,t.searchValue))}})]},proxy:!0}],null,!0)})})),1)])},r=[],n=s(8364),i=s(6188),c={name:"searchContent",data(){return{searchValue:"",timr:null,searchSuggestionList:[],searchHistory:JSON.parse((0,i.cF)("his"))||[]}},created(){},methods:{onCancel(){this.$router.go(-1)},clearSearch(){this.searchValue=""},inputFn(){clearTimeout(this.timr),this.timr=setTimeout((async()=>{if(0===this.searchValue.length)return;const t=await(0,n.sH)({q:this.searchValue});if(0!==t.data.data.options.length&&null!==t.data.data.options[0])this.searchSuggestionList=t.data.data.options;else{const t=["暂无搜索内容"];this.searchSuggestionList=t}}),500)},highlight(t,e){return t.replace(new RegExp(e,"gi"),(t=>`<span style="color:red">${t}</span>`))},onSearch(t){t.length>0&&(this.searchHistory.push(this.searchValue),setTimeout((()=>{this.$router.push(`/search_result/${t}`)}),0))},onSuggest(t){this.searchHistory.push(t),setTimeout((()=>{this.$router.push(`/search_result/${t}`)}),0)},onHistory(t){this.$router.push(`/search_result/${t}`)},clearFn(){this.searchHistory=[]}},watch:{searchHistory:{deep:!0,handler(){const t=new Set(this.searchHistory),e=Array.from(t);(0,i.po)("his",JSON.stringify(e))}}},components:{}},o=c,h=s(1001),u=(0,h.Z)(o,a,r,!1,null,"506bb06b",null),l=u.exports}}]);
//# sourceMappingURL=search.6d17b95f.js.map