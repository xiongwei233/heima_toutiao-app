{"version":3,"file":"js/home.3fa35989.js","mappings":"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","sources":["webpack://heima_toutiao-app/./src/views/home/index.vue?dcb5","webpack://heima_toutiao-app/./src/components/ArtileList.vue?5f68","webpack://heima_toutiao-app/src/components/ArtileList.vue","webpack://heima_toutiao-app/./src/components/ArtileList.vue?55a1","webpack://heima_toutiao-app/./src/components/ArtileList.vue","webpack://heima_toutiao-app/./src/views/home/channelEdit.vue?308e","webpack://heima_toutiao-app/src/views/home/channelEdit.vue","webpack://heima_toutiao-app/./src/views/home/channelEdit.vue?7bc7","webpack://heima_toutiao-app/./src/views/home/channelEdit.vue","webpack://heima_toutiao-app/src/views/home/index.vue","webpack://heima_toutiao-app/./src/views/home/index.vue?f727","webpack://heima_toutiao-app/./src/views/home/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-nav-bar',{attrs:{\"fixed\":\"\"},scopedSlots:_vm._u([{key:\"left\",fn:function(){return [_c('img',{staticClass:\"logo\",attrs:{\"src\":require(\"@/assets/toutiao_logo.png\")}})]},proxy:true},{key:\"right\",fn:function(){return [_c('van-icon',{attrs:{\"name\":\"search\",\"size\":\"4.8vw\",\"color\":\"#fff\"},on:{\"click\":_vm.moveSearch}})]},proxy:true}])}),_c('van-tabs',{attrs:{\"duration\":\"0\",\"animated\":\"\",\"sticky\":\"\",\"offset-top\":\"12.266667vw\"},on:{\"change\":_vm.changeChangeFn},model:{value:(_vm.channelId),callback:function ($$v) {_vm.channelId=$$v},expression:\"channelId\"}},_vm._l((_vm.channelsList),function(channel){return _c('van-tab',{key:channel.id,attrs:{\"name\":channel.id,\"title\":channel.name}},[_c('artile-list',{attrs:{\"channelId\":_vm.channelId}})],1)}),1),_c('van-icon',{staticClass:\"pushClass\",attrs:{\"name\":\"plus\"},on:{\"click\":_vm.addchannel}}),_c('van-popup',{staticClass:\"popupClass\",model:{value:(_vm.isShow),callback:function ($$v) {_vm.isShow=$$v},expression:\"isShow\"}},[_c('channel-edit',{ref:\"editRef\",attrs:{\"channel\":_vm.channelsList,\"unCheckChannel\":_vm.unCheckChannelsList},on:{\"closePopup\":_vm.closePopupFn,\"addEv\":_vm.addEvFn,\"removeEv\":_vm.removeEvFn,\"closeEv\":_vm.closeEvFn},model:{value:(_vm.channelId),callback:function ($$v) {_vm.channelId=$$v},expression:\"channelId\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"margin-top\":\"1.333333vw\"}},[_c('van-pull-refresh',{on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.isLoading),callback:function ($$v) {_vm.isLoading=$$v},expression:\"isLoading\"}},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"offset\":\"50\",\"immediate-check\":false},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.list),function(arr){return _c('artile-item',{key:arr.art_id,attrs:{\"arrChildren\":arr},on:{\"dislikes\":_vm.dislikesFn,\"reports\":_vm.reportsFn},nativeOn:{\"click\":function($event){return _vm.itemClickFn(arr.art_id)}}})}),1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div style=\"margin-top: 1.333333vw\">\r\n    <van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\">\r\n      <van-list\r\n        v-model=\"loading\"\r\n        :finished=\"finished\"\r\n        finished-text=\"没有更多了\"\r\n        offset=\"50\"\r\n        @load=\"onLoad\"\r\n        :immediate-check=\"false\"\r\n      >\r\n        <artile-item\r\n          @dislikes=\"dislikesFn\"\r\n          v-for=\"arr in list\"\r\n          :key=\"arr.art_id\"\r\n          :arrChildren=\"arr\"\r\n          @reports=\"reportsFn\"\r\n          @click.native=\"itemClickFn(arr.art_id)\"\r\n        ></artile-item>\r\n      </van-list>\r\n    </van-pull-refresh>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport artileItem from '@/components/ArtileItem'\r\nimport { getUsersArticlesAPI, notArtile, reportArtile } from '@/api'\r\nimport { Notify } from 'vant'\r\n\r\nexport default {\r\n  name: 'ArtileList',\r\n  props: {\r\n    channelId: Number\r\n  },\r\n  components: {\r\n    artileItem\r\n  },\r\n  data () {\r\n    return {\r\n      list: [],\r\n      loading: false,\r\n      finished: false,\r\n      // 时间戳，这里是用来做加载更多数据的请求值, 数据不同，值就不同，\r\n      theTime: '',\r\n      isLoading: false\r\n    }\r\n  },\r\n  created () {\r\n    this.changeChangeFn()\r\n  },\r\n  methods: {\r\n    // 优化请求，封装\r\n    async getArticleListFn () {\r\n      const res = await getUsersArticlesAPI({\r\n        channel_id: this.channelId, // 默认请求推荐频道\r\n        timestamp: this.theTime || new Date().getTime() // 时间戳\r\n      })\r\n\r\n      // 合并数据到 一个数组，\r\n      this.list = [ ...this.list, ...res.data.data.results ]\r\n      // 拿到新的时间戳,保存下一页数据的时间(做分页用)\r\n      this.theTime = res.data.data.pre_timestamp\r\n      // 等待网络请求结果后\r\n      // 底部加载更多状态\r\n      this.loading = false\r\n\r\n      // 如果返回的数据没有了，那么就停在触底发请求\r\n      if (res.data.data.pre_timestamp === null) {\r\n        this.finished = true\r\n      }\r\n      // 下拉刷新\r\n      this.isLoading = false\r\n    },\r\n\r\n    // 文章列表\r\n    async changeChangeFn () {\r\n      try {\r\n        this.getArticleListFn()\r\n      } catch (err) {\r\n        this.$toast.fail('获取用户的频道的数据失败')\r\n      }\r\n    },\r\n    // 底部加载事件\r\n    async onLoad () {\r\n      try {\r\n        // 如果当前没有数据了，那么finished就为false\r\n        if (this.list.length === 0) {\r\n          // 告诉list组件直接底部显示没有更多数\r\n          this.finished = true\r\n          return\r\n        }\r\n        this.getArticleListFn()\r\n      } catch (err) {\r\n        this.$toast.fail('获取用户的频道的数据失败')\r\n      }\r\n    },\r\n    // 下拉刷新\r\n    async onRefresh () {\r\n      // 清空数据和，重置时间戳\r\n      this.list = []\r\n      this.theTime = new Date().getTime()\r\n      this.getArticleListFn()\r\n    },\r\n\r\n    // 子组件的自定义事件，对文章不喜欢\r\n    async dislikesFn (id) {\r\n      try {\r\n        await notArtile(id)\r\n        Notify({ type: 'success', message: '反馈成功' })\r\n      } catch (err) {\r\n        Notify({ type: 'danger', message: err.message })\r\n      }\r\n    },\r\n    // 子组件的自定义事件，对文章的举报\r\n    async reportsFn (target, type, remark) {\r\n      try {\r\n        await reportArtile({ target, type, remark })\r\n        Notify({ type: 'success', message: '举报成功' })\r\n      } catch (err) {\r\n      }\r\n    },\r\n    // 点击新闻\r\n    itemClickFn (id) {\r\n      this.$router.push({ path: `/detail?art_id=${id}` })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped></style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ArtileList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ArtileList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ArtileList.vue?vue&type=template&id=f939160a&scoped=true&\"\nimport script from \"./ArtileList.vue?vue&type=script&lang=js&\"\nexport * from \"./ArtileList.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f939160a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-nav-bar',{attrs:{\"title\":\"编辑频道\",\"fixed\":\"\",\"placeholder\":\"\",\"safe-area-inset-top\":\"\"},on:{\"click-left\":_vm.onClickLeft},scopedSlots:_vm._u([{key:\"left\",fn:function(){return [_c('van-icon',{attrs:{\"name\":\"cross\",\"size\":\"4.8vw\"}})]},proxy:true}])}),_c('div',[_c('van-cell',{staticClass:\"tagBox\",attrs:{\"border\":false},scopedSlots:_vm._u([{key:\"right-icon\",fn:function(){return [_c('span',{staticClass:\"buttonChannel\",attrs:{\"type\":\"default\",\"size\":\"mini\"},on:{\"click\":_vm.addRemoveChannel}},[_vm._v(_vm._s(_vm.isEdit? \"完成\" : \"编辑\"))])]},proxy:true}])},[[_c('span',{staticClass:\"custom-title\"},[_vm._v(\"我的频道\")]),_c('span',{staticClass:\"tagChannel\"},[_vm._v(\"点击\"+_vm._s(_vm.isEdit? \"删除\" : \"进入\")+\"频道\")])]],2),_c('van-grid',{attrs:{\"direction\":\"horizontal\",\"column-num\":4,\"gutter\":10}},_vm._l((_vm.channel),function(item){return _c('van-grid-item',{key:item.id,on:{\"click\":function($event){return _vm.removeChannel(item)}}},[_vm._v(\" \"+_vm._s(item.name)+\" \"),_c('van-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isEdit && item.id !== 0 ),expression:\"isEdit && item.id !== 0 \"}],staticClass:\"removeChannel\",attrs:{\"name\":\"cross\"}})],1)}),1)],1),_c('div',[_c('van-cell',{staticClass:\"tagBox\",attrs:{\"border\":false}},[[_c('span',{staticClass:\"custom-title\"},[_vm._v(\"推荐频道\")]),_c('span',{staticClass:\"tagChannel\"},[_vm._v(\"点击添加频道\")])]],2),_c('van-grid',{attrs:{\"direction\":\"horizontal\",\"column-num\":4,\"gutter\":10}},_vm._l((_vm.unCheckChannel),function(item){return _c('van-grid-item',{key:item.id,on:{\"click\":function($event){return _vm.addChannel(item)}}},[_vm._v(_vm._s(item.name))])}),1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <van-nav-bar title=\"编辑频道\" fixed placeholder safe-area-inset-top @click-left=\"onClickLeft\">\r\n      <template #left>\r\n        <van-icon name=\"cross\" size=\"4.8vw\" />\r\n      </template>\r\n    </van-nav-bar>\r\n\r\n    <div>\r\n      <!-- 我的频道 -->\r\n      <van-cell class=\"tagBox\" :border=\"false\">\r\n        <template>\r\n          <span class=\"custom-title\">我的频道</span>\r\n          <span class=\"tagChannel\">点击{{isEdit? \"删除\" : \"进入\"}}频道</span>\r\n        </template>\r\n        <template #right-icon>\r\n          <span\r\n            class=\"buttonChannel\"\r\n            type=\"default\"\r\n            size=\"mini\"\r\n            @click=\"addRemoveChannel\"\r\n          >{{isEdit? \"完成\" : \"编辑\"}}</span>\r\n        </template>\r\n      </van-cell>\r\n      <van-grid direction=\"horizontal\" :column-num=\"4\" :gutter=\"10\">\r\n        <van-grid-item v-for=\"item in channel\" :key=\"item.id\" @click=\"removeChannel(item)\">\r\n          {{item.name}}\r\n          <!-- 删除按钮 -->\r\n          <!-- 如果当前点击了按钮，并且当前的id不等于0-->\r\n          <van-icon name=\"cross\" class=\"removeChannel\" v-show=\"isEdit && item.id !== 0 \" />\r\n        </van-grid-item>\r\n      </van-grid>\r\n    </div>\r\n\r\n    <div>\r\n      <!-- 推荐频道 -->\r\n      <van-cell class=\"tagBox\" :border=\"false\">\r\n        <template>\r\n          <span class=\"custom-title\">推荐频道</span>\r\n          <span class=\"tagChannel\">点击添加频道</span>\r\n        </template>\r\n      </van-cell>\r\n      <van-grid direction=\"horizontal\" :column-num=\"4\" :gutter=\"10\">\r\n        <van-grid-item\r\n          v-for=\"item in unCheckChannel\"\r\n          :key=\"item.id\"\r\n          @click=\"addChannel(item)\"\r\n        >{{item.name}}</van-grid-item>\r\n      </van-grid>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'channelEdit',\r\n  props: {\r\n    channel: Array,\r\n    unCheckChannel: Array\r\n  },\r\n  data () {\r\n    return {\r\n      isEdit: false\r\n    }\r\n  },\r\n  created () {\r\n  },\r\n  methods: {\r\n    // X关闭按钮\r\n    onClickLeft () {\r\n      this.$emit('closePopup')\r\n      // 也可以通过父组件绑定ref,拿到子组件的值，isEdit设置为false\r\n      // this.isEdit = false\r\n    },\r\n    // 编辑按钮\r\n    addRemoveChannel () {\r\n      this.isEdit = !this.isEdit\r\n    },\r\n    // 删除频道-我的频道板块\r\n    removeChannel (item) {\r\n      if (this.isEdit) {\r\n        if (item.id !== 0) {\r\n          this.$emit('removeEv', item)\r\n        }\r\n      } else {\r\n        this.$emit('closeEv')\r\n        this.$emit('input', item.id)\r\n      }\r\n    },\r\n    // 添加频道-推荐频道板块\r\n    addChannel (item) {\r\n      if (this.isEdit) {\r\n        this.$emit('addEv', item)\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped >\r\n.tagBox {\r\n  margin-top: 8px;\r\n\r\n  .custom-title {\r\n    font-size: 4.266667vw;\r\n  }\r\n\r\n  .tagChannel {\r\n    font-size: 3.2vw;\r\n    color: #c1c1c1;\r\n    padding: 0 14px;\r\n  }\r\n\r\n  .buttonChannel {\r\n    padding: 3px 12px;\r\n    border-radius: 40px;\r\n    border: 1px solid red;\r\n    font-size: 12px;\r\n    color: red;\r\n    line-height: normal;\r\n  }\r\n}\r\n/deep/.van-grid-item__content {\r\n  padding: 2.666667vw 2.133333vw;\r\n  background-color: #f9f9f9;\r\n  font-size: 13px;\r\n}\r\n.removeChannel {\r\n  font-size: 10px;\r\n  color: #b3b1b1;\r\n  border: 1px solid #b3b1b1;\r\n  position: absolute;\r\n  right: -3px;\r\n  top: -3px;\r\n  border-radius: 50%;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./channelEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./channelEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./channelEdit.vue?vue&type=template&id=e33a3f5c&scoped=true&\"\nimport script from \"./channelEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./channelEdit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./channelEdit.vue?vue&type=style&index=0&id=e33a3f5c&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e33a3f5c\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <!-- headers -->\r\n    <van-nav-bar fixed>\r\n      <template v-slot:left>\r\n        <img class=\"logo\" src=\"@/assets/toutiao_logo.png\" />\r\n      </template>\r\n      <template #right>\r\n        <van-icon name=\"search\" size=\"4.8vw\" color=\"#fff\" @click=\"moveSearch\" />\r\n      </template>\r\n    </van-nav-bar>\r\n\r\n    <!-- tab标签 -->\r\n    <van-tabs\r\n      v-model=\"channelId\"\r\n      duration=\"0\"\r\n      animated\r\n      @change=\"changeChangeFn\"\r\n      sticky\r\n      offset-top=\"12.266667vw\"\r\n    >\r\n      <van-tab\r\n        v-for=\"channel in channelsList\"\r\n        :name=\"channel.id\"\r\n        :key=\"channel.id\"\r\n        :title=\"channel.name\"\r\n      >\r\n        <artile-list :channelId=\"channelId\"></artile-list>\r\n      </van-tab>\r\n    </van-tabs>\r\n\r\n    <van-icon name=\"plus\" class=\"pushClass\" @click=\"addchannel\" />\r\n\r\n    <van-popup class=\"popupClass\" v-model=\"isShow\">\r\n      <channel-edit\r\n        :channel=\"channelsList\"\r\n        @closePopup=\"closePopupFn\"\r\n        :unCheckChannel=\"unCheckChannelsList\"\r\n        @addEv=\"addEvFn\"\r\n        @removeEv=\"removeEvFn\"\r\n        ref=\"editRef\"\r\n        v-model=\"channelId\"\r\n        @closeEv=\"closeEvFn\"\r\n      ></channel-edit>\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getUsersChannelsAPI, getUsersArticlesAPI, getAllUsersChannelsAPI, putChannelsAPI, deleteChannelsAPI } from '@/api'\r\nimport artileList from '@/components/ArtileList.vue'\r\nimport channelEdit from '@/views/home/channelEdit.vue'\r\nexport default {\r\n  name: 'layoutHome',\r\n  data () {\r\n    return {\r\n      // 这里的值是 van-tab的name传过来的,\r\n      // 文档规定了  name: 标签名称，作为匹配的标识符/标签的索引值\r\n      // 所以这里绑定的是当前 选中频道的id，\r\n      channelId: 0,\r\n      // 用户的频道\r\n      channelsList: [],\r\n      // 所有频道\r\n      allChannelsList: [],\r\n      // 内容区域的数据\r\n      artileList: [],\r\n      isShow: false,\r\n\r\n      // 设置每个频道的滚动位置\r\n      channelScrollTObj: {}\r\n      // 值{频道id:滚动位置, 频道id2:滚动位置2,}\r\n    }\r\n  },\r\n  async created () {\r\n    this.getChannelsList()\r\n  },\r\n  methods: {\r\n    async getChannelsList () {\r\n      try {\r\n        // 用户频道列表\r\n        const res = await getUsersChannelsAPI()\r\n        this.channelsList = res.data.data.channels\r\n\r\n        // 所有频道列表\r\n        const res2 = await getAllUsersChannelsAPI()\r\n        this.allChannelsList = res2.data.data.channels\r\n\r\n        // 文章列表\r\n        this.changeChangeFn()\r\n      } catch (err) {\r\n        this.$toast.fail('获取用户的频道失败')\r\n      }\r\n    },\r\n    // 文章频道列表channge事件\r\n    async changeChangeFn (name) {\r\n      this.$nextTick(() => {\r\n        // 频道切换，滚到到 每个频道保存的滚动位置，\r\n        document.documentElement.scrollTop = this.channelScrollTObj[ this.channelId ]\r\n        console.log(this.channelScrollTObj[ this.channelId ])\r\n      })\r\n\r\n      console.log('name的值' + name)\r\n      try {\r\n        const res2 = await getUsersArticlesAPI({\r\n          channel_id: this.channelId, // 默认请求推荐频道\r\n          timestamp: new Date().getTime()\r\n        })\r\n        this.artileList = res2.data.data.results\r\n      } catch (err) {\r\n        this.$toast.fail('获取用户的频道的数据失败')\r\n      }\r\n    },\r\n    // 添加频道的按钮\r\n    addchannel () {\r\n      this.isShow = true\r\n    },\r\n    // 关闭遮罩层\r\n    closePopupFn () {\r\n      this.isShow = false\r\n      this.$refs.editRef.isEdit = false\r\n    },\r\n    // 选择频道之后\r\n    closeEvFn () {\r\n      this.isShow = false\r\n    },\r\n    // 添加频道\r\n    async addEvFn (item) {\r\n      try {\r\n        this.channelsList.push(item)\r\n        // 去掉推荐的频道\r\n        const newArr = this.channelsList.filter(item => item.id !== 0)\r\n        // 浅拷贝一下, 并对值进行修改\r\n        // map(): 根据对每个元素调用 func 的结果创建一个新数组\r\n        const newChannelsList = newArr.map((item, index) => {\r\n          const newObj = { ...item } // 浅拷贝\r\n          delete newObj.name\r\n          newObj.seq = index\r\n          return newObj\r\n        })\r\n        await putChannelsAPI({ channels: newChannelsList })\r\n      } catch (err) {\r\n        this.$toast.fail('频道添加失败')\r\n        // 当我添加频道失败，那么就重新获取频道数据，重置掉旧数据\r\n        this.getChannelsList()\r\n      }\r\n    },\r\n    // 删除频道\r\n    async removeEvFn (item) {\r\n      try {\r\n        const index = this.channelsList.findIndex(channel => channel.id === item.id)\r\n        this.channelsList.splice(index, 1)\r\n        await deleteChannelsAPI({ id: item.id })\r\n      } catch (err) {\r\n        this.$toast.fail('频道删除失败')\r\n        // 当我删除频道失败，那么就重新获取频道数据，重置掉旧数据\r\n        this.getChannelsList()\r\n      }\r\n    },\r\n    // 搜索图标\r\n    moveSearch () {\r\n      this.$router.push('/search')\r\n    },\r\n    // 监听网页的滚动事件\r\n    scrollFn () {\r\n      // 把把页面内容卷入的距离，保存在路由设置的值上\r\n      this.$route.meta.scrollTValue = document.documentElement.scrollTop\r\n      // 保存每个频道的滚动位置\r\n      this.channelScrollTObj[ this.channelId ] = document.documentElement.scrollTop\r\n      console.log(this.channelScrollTObj)\r\n    }\r\n  },\r\n  computed: {\r\n    // 计算频道\r\n    unCheckChannelsList () {\r\n      // 方法1\r\n      // return this.allChannelsList.filter(allchannel => {\r\n      //   return this.channelsList.find(userchannel => {\r\n      //     return userchannel.id === allchannel.id\r\n      //   })\r\n      // })\r\n      // }\r\n\r\n      // 方法2\r\n      // const arr = []\r\n      // this.allChannelsList.forEach(channel => {\r\n      //   let falg = false\r\n      //   for (let i = 0; i < this.channelsList.length; i++) {\r\n      //     if (this.channelsList[ i ].id === channel.id) {\r\n      //       falg = true\r\n      //       break\r\n      //     }\r\n      //   }\r\n      //   if (!falg) {\r\n      //     arr.push(channel)\r\n      //   }\r\n      // })\r\n      // return arr\r\n\r\n      // 方法3\r\n      // const newArr = this.allChannelsList.filter(allChannel => {\r\n      //   // findIndex: 在channelsList里面查找，如果channelsList.id和allChannelsList.id一样，当前符合条件的索引号，不一样返回-1\r\n      //   const index = this.channelsList.findIndex(channel => {\r\n      //     return channel.id === allChannel.id\r\n      //   })\r\n\r\n      //   // 如果没有找到返回false， 找到了返回true，因为filter接收布尔值\r\n      //   if (index > -1) {\r\n      //     return false\r\n      //   } else {\r\n      //     return true\r\n      //   }\r\n      // })\r\n      // return newArr\r\n\r\n      // 方法3 简写：\r\n      return this.allChannelsList.filter(\r\n        allChannel => (this.channelsList.findIndex(channel => allChannel.id === channel.id) === -1\r\n        )\r\n      )\r\n    }\r\n  },\r\n  // 页面打开\r\n  activated () {\r\n    console.log(this.$route)\r\n    // 监听 scroll 滚动事件\r\n    window.addEventListener('scroll', this.scrollFn)\r\n    // 设置滚动条的位置\r\n    document.documentElement.scrollTop = this.$route.meta.scrollTValue\r\n  },\r\n  // 页面刷新\r\n  deactivated () {\r\n    // 销毁事件，提高性能\r\n    window.removeEventListener('scroll', this.scrollFn)\r\n  },\r\n  components: {\r\n    artileList,\r\n    channelEdit\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped >\r\n.logo {\r\n  width: 100px;\r\n  height: 30px;\r\n}\r\n.van-tabs {\r\n  padding-top: 12.266667vw;\r\n}\r\n\r\n/deep/.van-tabs__wrap {\r\n  position: fixed;\r\n  top: 12.266667vw;\r\n  left: 0;\r\n  right: 0;\r\n}\r\n/deep/.van-tabs__content {\r\n  margin-top: 44px;\r\n  // font-size: 3.733333vw; // 把内容区域的字体都固定了\r\n}\r\n.pushClass {\r\n  font-size: 4.5vw;\r\n  position: fixed;\r\n  right: 0;\r\n  top: 46px;\r\n  line-height: 44px;\r\n  padding: 0 8px;\r\n  background-color: #fff;\r\n  display: block;\r\n  z-index: 120;\r\n}\r\n/deep/.van-tabs__nav {\r\n  padding-right: 32px;\r\n}\r\n.popupClass {\r\n  width: 100vw;\r\n  height: 100vh;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=9b7e4b4e&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=9b7e4b4e&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9b7e4b4e\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","scopedSlots","_u","key","fn","staticClass","proxy","on","moveSearch","changeChangeFn","model","value","callback","$$v","channelId","expression","_l","channel","id","name","addchannel","isShow","ref","channelsList","unCheckChannelsList","closePopupFn","addEvFn","removeEvFn","closeEvFn","staticRenderFns","staticStyle","onRefresh","isLoading","finished","onLoad","loading","arr","art_id","dislikesFn","reportsFn","nativeOn","$event","itemClickFn","props","components","artileItem","data","list","theTime","created","methods","channel_id","timestamp","type","message","target","remark","path","component","onClickLeft","addRemoveChannel","_v","_s","isEdit","item","removeChannel","directives","rawName","addChannel","unCheckChannel","allChannelsList","artileList","channelScrollTObj","document","console","newObj","channels","scrollFn","computed","allChannel","activated","window","deactivated","channelEdit"],"sourceRoot":""}