{"version":3,"file":"js/search.6d17b95f.js","mappings":"8KAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,OAAO,CAACG,MAAM,CAAC,OAAS,MAAM,CAACH,EAAG,aAAa,CAACI,WAAW,CAAC,CAACC,KAAK,aAAaC,QAAQ,iBAAiBJ,YAAY,cAAcC,MAAM,CAAC,cAAc,GAAG,YAAc,WAAW,UAAY,GAAG,MAAQ,QAAQ,MAAQ,IAAII,GAAG,CAAC,OAASX,EAAIY,SAAS,OAASZ,EAAIa,SAAS,MAAQb,EAAIc,YAAY,MAAQd,EAAIe,SAASC,MAAM,CAACC,MAAOjB,EAAe,YAAEkB,SAAS,SAAUC,GAAMnB,EAAIoB,YAA4B,kBAARD,EAAkBA,EAAIE,OAAQF,GAAMG,WAAW,kBAAkB,GAA6B,IAAzBtB,EAAIoB,YAAYG,OAAYnB,EAAG,MAAM,CAACA,EAAG,WAAW,CAACE,YAAY,SAASkB,YAAYxB,EAAIyB,GAAG,CAAC,CAACC,IAAI,aAAaC,GAAG,WAAW,MAAO,CAACvB,EAAG,WAAW,CAACG,MAAM,CAAC,KAAO,WAAW,KAAO,cAAcI,GAAG,CAAC,MAAQX,EAAI4B,aAAaC,OAAM,IAAO,MAAK,EAAM,aAAa,CAAC,CAACzB,EAAG,OAAO,CAACE,YAAY,gBAAgB,CAACN,EAAI8B,GAAG,YAAY,GAAG1B,EAAG,WAAW,CAACE,YAAY,UAAUC,MAAM,CAAC,OAAS,KAAKP,EAAI+B,GAAI/B,EAAiB,eAAE,SAASgC,EAAKC,GAAO,OAAO7B,EAAG,OAAO,CAACsB,IAAIO,EAAMtB,GAAG,CAAC,MAAQ,SAASuB,GAAQ,OAAOlC,EAAImC,UAAUH,MAAS,CAAChC,EAAI8B,GAAG9B,EAAIoC,GAAGJ,SAAW,IAAI,GAAG5B,EAAG,MAAMJ,EAAI+B,GAAI/B,EAAwB,sBAAE,SAASgC,EAAKC,GAAO,OAAO7B,EAAG,WAAW,CAACsB,IAAIO,EAAM1B,MAAM,CAAC,KAAO,UAAUI,GAAG,CAAC,MAAQ,SAASuB,GAAQ,OAAOlC,EAAIqC,UAAUL,KAAQR,YAAYxB,EAAIyB,GAAG,CAAC,CAACC,IAAI,QAAQC,GAAG,WAAW,MAAO,CAACvB,EAAG,MAAM,CAACkC,SAAS,CAAC,UAAYtC,EAAIoC,GAAGpC,EAAIuC,UAAUP,EAAKhC,EAAIoB,mBAAmBS,OAAM,IAAO,MAAK,QAAU,MAC78CW,EAAkB,G,oBCqDtB,GACA/B,KAAAA,gBACAgC,OACA,OACArB,YAAAA,GACAsB,KAAAA,KAEAC,qBAAAA,GAEAC,cAAAA,KAAAA,OAAAA,EAAAA,EAAAA,IAAAA,SAAAA,KAGAC,YAEAC,QAAAA,CACAjC,WAEA,qBAGAC,cACA,qBAGAC,UAEAgC,aAAAA,KAAAA,MACA,gCAEA,sCAGA,uBAAAC,EAAAA,KAAAA,cAEA,iEACA,kDACA,CAEA,mBACA,+BAEA,MAKAT,UAAAA,EAAAA,GACA,iBAKA,oBAAAU,GAGA,yCAOArC,SAAAA,GAEA,aACA,0CAGAsC,YAAAA,KACA,2CACA,KAIAb,UAAAA,GACA,2BACAa,YAAAA,KACA,2CACA,IAGAf,UAAAA,GACA,0CAGAP,UACA,wBAGAuB,MAAAA,CAEAP,cAAAA,CACAQ,MAAAA,EACAC,UAIA,oCAEA,iBACAC,EAAAA,EAAAA,IAAAA,MAAAA,KAAAA,UAAAA,OAIAC,WAAAA,IC9J0Q,I,UCQtQC,GAAY,OACd,EACAzD,EACAyC,GACA,EACA,KACA,WACA,MAIF,EAAegB,EAAiB","sources":["webpack://heima_toutiao-app/./src/views/search/index.vue?4a74","webpack://heima_toutiao-app/src/views/search/index.vue","webpack://heima_toutiao-app/./src/views/search/index.vue?f0c1","webpack://heima_toutiao-app/./src/views/search/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"appBox\"},[_c('form',{attrs:{\"action\":\"/\"}},[_c('van-search',{directives:[{name:\"inputFocus\",rawName:\"v-inputFocus\"}],staticClass:\"searchClass\",attrs:{\"show-action\":\"\",\"placeholder\":\"请输入搜索关键词\",\"clearable\":\"\",\"shape\":\"round\",\"fixed\":\"\"},on:{\"search\":_vm.onSearch,\"cancel\":_vm.onCancel,\"clear\":_vm.clearSearch,\"input\":_vm.inputFn},model:{value:(_vm.searchValue),callback:function ($$v) {_vm.searchValue=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"searchValue\"}})],1),(_vm.searchValue.length===0)?_c('div',[_c('van-cell',{staticClass:\"tagBox\",scopedSlots:_vm._u([{key:\"right-icon\",fn:function(){return [_c('van-icon',{attrs:{\"name\":\"delete-o\",\"size\":\"4.266667vw\"},on:{\"click\":_vm.clearFn}})]},proxy:true}],null,false,2059379864)},[[_c('span',{staticClass:\"custom-title\"},[_vm._v(\"历史记录\")])]],2),_c('van-grid',{staticClass:\"gridBox\",attrs:{\"gutter\":10}},_vm._l((_vm.searchHistory),function(item,index){return _c('span',{key:index,on:{\"click\":function($event){return _vm.onHistory(item)}}},[_vm._v(_vm._s(item))])}),0)],1):_c('div',_vm._l((_vm.searchSuggestionList),function(item,index){return _c('van-cell',{key:index,attrs:{\"icon\":\"search\"},on:{\"click\":function($event){return _vm.onSuggest(item)}},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.highlight(item,_vm.searchValue))}})]},proxy:true}],null,true)})}),1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"appBox\">\r\n    <form action=\"/\">\r\n      <van-search\r\n        class=\"searchClass\"\r\n        v-model.trim=\"searchValue\"\r\n        show-action\r\n        placeholder=\"请输入搜索关键词\"\r\n        @search=\"onSearch\"\r\n        @cancel=\"onCancel\"\r\n        clearable\r\n        @clear=\"clearSearch\"\r\n        v-inputFocus\r\n        @input=\"inputFn\"\r\n        shape=\"round\"\r\n        fixed\r\n      />\r\n    </form>\r\n\r\n    <!-- 历史记录 -->\r\n    <div v-if=\"searchValue.length===0\">\r\n      <van-cell class=\"tagBox\">\r\n        <template>\r\n          <span class=\"custom-title\">历史记录</span>\r\n        </template>\r\n        <template #right-icon>\r\n          <van-icon name=\"delete-o\" size=\"4.266667vw\" @click=\"clearFn\" />\r\n        </template>\r\n      </van-cell>\r\n      <van-grid class=\"gridBox\" :gutter=\"10\">\r\n        <span v-for=\"(item,index) in searchHistory\" :key=\"index\" @click=\"onHistory(item)\">{{item}}</span>\r\n      </van-grid>\r\n    </div>\r\n\r\n    <!-- 搜索内容 -->\r\n    <div v-else>\r\n      <van-cell\r\n        icon=\"search\"\r\n        v-for=\"(item,index) in searchSuggestionList\"\r\n        :key=\"index\"\r\n        @click=\"onSuggest(item)\"\r\n      >\r\n        <!-- 使用 title 插槽来自定义标题 -->\r\n        <template #title>\r\n          <div v-html=\"highlight(item,searchValue)\"></div>\r\n        </template>\r\n      </van-cell>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { searchSuggestionApi } from '@/api'\r\nimport { setStorage, getStorage } from '@/util/storage'\r\nexport default {\r\n  name: 'searchContent',\r\n  data () {\r\n    return {\r\n      searchValue: '',\r\n      timr: null, // 防抖的定时器\r\n      // 搜索得到的内容\r\n      searchSuggestionList: [],\r\n      // 搜索历史\r\n      searchHistory: JSON.parse(getStorage('his')) || [] // 搜索历史\r\n    }\r\n  },\r\n  created () {\r\n  },\r\n  methods: {\r\n    onCancel () {\r\n      // this.$router.push('/layout/home')\r\n      this.$router.go(-1) // 表示后退一步\r\n    },\r\n    // 点击清除按钮\r\n    clearSearch () {\r\n      this.searchValue = ''\r\n    },\r\n    // 搜索输入框的input事件 => 防抖\r\n    inputFn () {\r\n      // 如果有这个定时器，就停止\r\n      clearTimeout(this.timr)\r\n      this.timr = setTimeout(async () => {\r\n        // 如果输入框没有内容，就停止运行\r\n        if (this.searchValue.length === 0) return\r\n        // 防止空内容触发下面逻辑\r\n        // 发起请求\r\n        const res = await searchSuggestionApi({ q: this.searchValue })\r\n        // 有搜索内容\r\n        if (res.data.data.options.length !== 0 && res.data.data.options[ 0 ] !== null) {\r\n          this.searchSuggestionList = res.data.data.options\r\n        } else {\r\n          // 没有搜索内容\r\n          const a = [ '暂无搜索内容' ]\r\n          this.searchSuggestionList = a\r\n        }\r\n      }, 500)\r\n    },\r\n    // 搜索高亮\r\n    // originStr 是当前搜索得到的数据\r\n    // target 是当前搜索的关键词\r\n    highlight (originStr, target) {\r\n      return originStr.replace(\r\n        // RegExp 是正则表达式的构造函数\r\n        // 参数1: 字符串\r\n        // 参数2：匹配对象\r\n        // 返回值：正则对象\r\n        new RegExp(target, 'gi'), (match) => {\r\n          // 这个函数是防止把符合条件都改成大写或者小写了,\r\n          //\r\n          return `<span style=\"color:red\">${match}</span>`\r\n        }\r\n        // 正则的g是全局效果，i表示不区分大小写\r\n      )\r\n    },\r\n\r\n    // 搜索框回车\r\n    onSearch (str) {\r\n      // 防止输入空格就跳转了\r\n      if (str.length > 0) {\r\n        this.searchHistory.push(this.searchValue)\r\n        // 这里表示，先让历史记录添加到token，再进行跳转，\r\n        // 如果先调整，那么数据就没了\r\n        setTimeout(() => {\r\n          this.$router.push(`/search_result/${str}`)\r\n        }, 0)\r\n      }\r\n    },\r\n    // 点击搜索联想建议\r\n    onSuggest (str) {\r\n      this.searchHistory.push(str)\r\n      setTimeout(() => {\r\n        this.$router.push(`/search_result/${str}`)\r\n      }, 0)\r\n    },\r\n    // 点击历史记录\r\n    onHistory (str) {\r\n      this.$router.push(`/search_result/${str}`)\r\n    },\r\n    // 清空历史记录\r\n    clearFn () {\r\n      this.searchHistory = []\r\n    }\r\n  },\r\n  watch: {\r\n    // 监听历史记录\r\n    searchHistory: {\r\n      deep: true,\r\n      handler () {\r\n        // set：无序不重复的value集合体(无下角标),\r\n        // 特点: 传入的数组类型，如果有重复元素，自动清除掉重复元素，返回无重复的set对象\r\n        // 注意: 如果值是对象，比较的是对象的内存地址\r\n        const theSet = new Set(this.searchHistory)\r\n        // set类型对象 转成 Array数组类型\r\n        const arr = Array.from(theSet)\r\n        setStorage('his', JSON.stringify(arr))\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped >\r\n.appBox {\r\n  padding-top: 54px;\r\n}\r\n.custom-title {\r\n  font-size: 3.733333vw;\r\n}\r\n\r\n.gridBox {\r\n  margin-top: 10px;\r\n  span {\r\n    padding: 8px 10px;\r\n    border-radius: 6px;\r\n    background-color: #f5f5f5;\r\n    font-size: 14px;\r\n    margin: 5px 10px 5px 0;\r\n    color: #111;\r\n  }\r\n}\r\n.searchClass {\r\n  position: fixed;\r\n  top: 0;\r\n  right: 0;\r\n  left: 0;\r\n  z-index: 99;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=506bb06b&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=506bb06b&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"506bb06b\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","directives","name","rawName","on","onSearch","onCancel","clearSearch","inputFn","model","value","callback","$$v","searchValue","trim","expression","length","scopedSlots","_u","key","fn","clearFn","proxy","_v","_l","item","index","$event","onHistory","_s","onSuggest","domProps","highlight","staticRenderFns","data","timr","searchSuggestionList","searchHistory","created","methods","clearTimeout","q","match","setTimeout","watch","deep","handler","setStorage","components","component"],"sourceRoot":""}